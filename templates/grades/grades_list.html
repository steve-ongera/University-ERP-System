{% extends 'admin_base.html' %}
{% load static %}

{% block content %}

<div class="row mt-3">
    <div class="col-md-12">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
            <i class="bi {% if message.tags == 'success' %}bi-check-circle{% else %}bi-exclamation-triangle{% endif %} me-2"></i>
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
</div>

<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h2 class="fw-bold mb-1">
                                <i class="bi bi-clipboard-data me-2 text-primary"></i>
                                Grades Management
                            </h2>
                            <p class="text-muted mb-0">View and manage student grades across all programmes</p>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-secondary" onclick="expandAll()">
                                <i class="bi bi-arrows-expand"></i> Expand All
                            </button>
                            <button class="btn btn-outline-secondary" onclick="collapseAll()">
                                <i class="bi bi-arrows-collapse"></i> Collapse All
                            </button>
                            <button class="btn btn-success" onclick="downloadPDF()">
                                <i class="bi bi-file-earmark-pdf"></i> Download PDF
                            </button>
                            <button class="btn btn-primary" onclick="exportToExcel()">
                                <i class="bi bi-file-earmark-excel"></i> Export Excel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4 class="mb-1">{{ total_students }}</h4>
                            <p class="mb-0">Total Students</p>
                        </div>
                        <div class="align-self-center">
                            <i class="bi bi-people fs-1"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4 class="mb-1">{{ total_grades }}</h4>
                            <p class="mb-0">Total Grades</p>
                        </div>
                        <div class="align-self-center">
                            <i class="bi bi-clipboard-check fs-1"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4 class="mb-1">{{ average_gpa }}</h4>
                            <p class="mb-0">Average GPA</p>
                        </div>
                        <div class="align-self-center">
                            <i class="bi bi-graph-up fs-1"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h4 class="mb-1">{{ grade_distribution.A|default:0 }}</h4>
                            <p class="mb-0">A Grades</p>
                        </div>
                        <div class="align-self-center">
                            <i class="bi bi-trophy fs-1"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="bi bi-funnel me-2"></i>Filters
                        <button class="btn btn-sm btn-outline-secondary float-end" onclick="clearFilters()">
                            <i class="bi bi-x-circle"></i> Clear All
                        </button>
                    </h5>
                </div>
                <div class="card-body">
                    <form method="GET" id="filterForm">
                        <div class="row g-3">
                            <!-- Academic Year -->
                            <div class="col-md-3">
                                <label class="form-label">Academic Year</label>
                                <select name="academic_year" class="form-select" id="academicYearSelect">
                                    <option value="">All Years</option>
                                    {% for year in academic_years %}
                                        <option value="{{ year.id }}" 
                                                {% if filters.academic_year_id == year.id|stringformat:"s" %}selected{% endif %}>
                                            {{ year.year }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Semester -->
                            <div class="col-md-3">
                                <label class="form-label">Semester</label>
                                <select name="semester" class="form-select" id="semesterSelect">
                                    <option value="">All Semesters</option>
                                    {% for semester in semesters %}
                                        <option value="{{ semester.id }}" 
                                                data-year="{{ semester.academic_year.id }}"
                                                {% if filters.semester_id == semester.id|stringformat:"s" %}selected{% endif %}>
                                            {{ semester.academic_year.year }} - Semester {{ semester.semester_number }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Programme -->
                            <div class="col-md-3">
                                <label class="form-label">Programme</label>
                                <select name="programme" class="form-select">
                                    <option value="">All Programmes</option>
                                    {% for programme in programmes %}
                                        <option value="{{ programme.id }}" 
                                                {% if filters.programme_id == programme.id|stringformat:"s" %}selected{% endif %}>
                                            {{ programme.name }} ({{ programme.code }})
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Department -->
                            <div class="col-md-3">
                                <label class="form-label">Department</label>
                                <select name="department" class="form-select">
                                    <option value="">All Departments</option>
                                    {% for department in departments %}
                                        <option value="{{ department.id }}" 
                                                {% if filters.department_id == department.id|stringformat:"s" %}selected{% endif %}>
                                            {{ department.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Student Search -->
                            <div class="col-md-4">
                                <label class="form-label">Student Search</label>
                                <input type="text" name="student_search" class="form-control" 
                                       placeholder="Search by name or student ID" 
                                       value="{{ filters.student_search }}">
                            </div>

                            <!-- Course Search -->
                            <div class="col-md-4">
                                <label class="form-label">Course Search</label>
                                <input type="text" name="course_search" class="form-control" 
                                       placeholder="Search by course name or code" 
                                       value="{{ filters.course_search }}">
                            </div>

                            <!-- Grade Filter -->
                            <div class="col-md-4">
                                <label class="form-label">Grade</label>
                                <select name="grade_filter" class="form-select">
                                    <option value="">All Grades</option>
                                    {% for grade_code, grade_display in grade_choices %}
                                        <option value="{{ grade_code }}" 
                                                {% if filters.grade_filter == grade_code %}selected{% endif %}>
                                            {{ grade_display }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-search"></i> Apply Filters
                                </button>
                                <button type="button" class="btn btn-outline-secondary ms-2" onclick="clearFilters()">
                                    <i class="bi bi-arrow-clockwise"></i> Reset
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Grades List -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Student Grades</h5>
                    <div class="text-muted">
                        <small>Click on a student card to expand/collapse details</small>
                    </div>
                </div>
                <div class="card-body">
                    <div id="gradesContainer">
                        {% for student_data in students_grades %}
                            <div class="student-card mb-3 border rounded" data-student-id="{{ student_data.student.student_id }}">
                                <!-- Student Header (Always Visible) -->
                                <div class="student-header p-3 cursor-pointer" onclick="toggleStudentGrades('{{ student_data.student.student_id }}')">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <div class="d-flex align-items-center">
                                                <i class="bi bi-chevron-right chevron-icon me-2 text-muted transition-all"></i>
                                                <div>
                                                    <h6 class="mb-1 text-primary fw-bold">
                                                        <i class="bi bi-person-circle me-1"></i>
                                                        {{ student_data.student.user.get_full_name }}
                                                    </h6>
                                                    <div class="d-flex flex-wrap gap-3 text-muted small">
                                                        <span><strong>ID:</strong> {{ student_data.student.student_id }}</span>
                                                        <span><strong>Programme:</strong> {{ student_data.student.programme.code }}</span>
                                                        <span><strong>Year:</strong> {{ student_data.student.current_year }}</span>
                                                        <span><strong>Semester:</strong> {{ student_data.student.current_semester }}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="row text-center">
                                                <div class="col-4">
                                                    <div class="stat-box">
                                                        <div class="h5 mb-0 text-success">{{ student_data.gpa|default:"-" }}</div>
                                                        <small class="text-muted">GPA</small>
                                                    </div>
                                                </div>
                                                <div class="col-4">
                                                    <div class="stat-box">
                                                        <div class="h5 mb-0 text-info">{{ student_data.total_credits|default:0 }}</div>
                                                        <small class="text-muted">Credits</small>
                                                    </div>
                                                </div>
                                                <div class="col-4">
                                                    <div class="stat-box">
                                                        <div class="h5 mb-0 text-warning">{{ student_data.grades|length }}</div>
                                                        <small class="text-muted">Courses</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Student Grades (Collapsible) -->
                                <div class="student-grades collapse" id="grades-{{ student_data.student.student_id }}">
                                    <div class="border-top">
                                        <div class="table-responsive">
                                            <table class="table table-sm table-hover mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th width="10%">Course Code</th>
                                                        <th width="25%">Course Name</th>
                                                        <th width="8%">Credits</th>
                                                        <th width="10%">CAT</th>
                                                        <th width="10%">Exam</th>
                                                        <th width="10%">Total</th>
                                                        <th width="8%">Grade</th>
                                                        <th width="8%">Points</th>
                                                        <th width="11%">Semester</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for grade in student_data.grades %}
                                                        <tr>
                                                            <td>
                                                                <span class="badge bg-secondary">{{ grade.enrollment.course.code }}</span>
                                                            </td>
                                                            <td>
                                                                <div class="fw-medium">{{ grade.enrollment.course.name }}</div>
                                                            </td>
                                                            <td class="text-center">{{ grade.enrollment.course.credit_hours }}</td>
                                                            <td class="text-center">
                                                                {% if grade.continuous_assessment %}
                                                                    {{ grade.continuous_assessment|floatformat:1 }}
                                                                {% else %}
                                                                    <span class="text-muted">-</span>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                {% if grade.final_exam %}
                                                                    {{ grade.final_exam|floatformat:1 }}
                                                                {% else %}
                                                                    <span class="text-muted">-</span>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                {% if grade.total_marks %}
                                                                    <strong>{{ grade.total_marks|floatformat:1 }}%</strong>
                                                                {% else %}
                                                                    <span class="text-muted">-</span>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                {% if grade.grade %}
                                                                    <span class="badge bg-{% if grade.is_passed %}success{% else %}danger{% endif %}">
                                                                        {{ grade.grade }}
                                                                    </span>
                                                                {% else %}
                                                                    <span class="text-muted">-</span>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                {% if grade.grade_points %}
                                                                    {{ grade.grade_points|floatformat:1 }}
                                                                {% else %}
                                                                    <span class="text-muted">-</span>
                                                                {% endif %}
                                                            </td>
                                                            <td class="text-center">
                                                                <small class="text-muted">
                                                                    {{ grade.enrollment.semester.academic_year.year }}<br>
                                                                    Sem {{ grade.enrollment.semester.semester_number }}
                                                                </small>
                                                            </td>
                                                        </tr>
                                                    {% empty %}
                                                        <tr>
                                                            <td colspan="9" class="text-center text-muted py-3">
                                                                No grades recorded for this student
                                                            </td>
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% empty %}
                            <div class="text-center py-5">
                                <i class="bi bi-inbox display-1 text-muted"></i>
                                <h4 class="text-muted mt-3">No grades found</h4>
                                <p class="text-muted">Try adjusting your filters to see results.</p>
                            </div>
                        {% endfor %}
                    </div>

                    <!-- Pagination -->
                    {% if students_grades.has_other_pages %}
                        <nav aria-label="Grades pagination" class="mt-4">
                            <ul class="pagination justify-content-center">
                                {% if students_grades.has_previous %}
                                    <li class="page-item">
                                        <a class="page-link" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ students_grades.previous_page_number }}">
                                            <i class="bi bi-chevron-left"></i>
                                        </a>
                                    </li>
                                {% endif %}

                                {% for num in students_grades.paginator.page_range %}
                                    {% if students_grades.number == num %}
                                        <li class="page-item active">
                                            <span class="page-link">{{ num }}</span>
                                        </li>
                                    {% else %}
                                        <li class="page-item">
                                            <a class="page-link" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ num }}">{{ num }}</a>
                                        </li>
                                    {% endif %}
                                {% endfor %}

                                {% if students_grades.has_next %}
                                    <li class="page-item">
                                        <a class="page-link" href="?{% for key, value in request.GET.items %}{% if key != 'page' %}{{ key }}={{ value }}&{% endif %}{% endfor %}page={{ students_grades.next_page_number }}">
                                            <i class="bi bi-chevron-right"></i>
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </nav>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Academic Year and Semester filtering
    const academicYearSelect = document.getElementById('academicYearSelect');
    const semesterSelect = document.getElementById('semesterSelect');
    
    function filterSemesters() {
        const selectedYear = academicYearSelect.value;
        const semesterOptions = semesterSelect.querySelectorAll('option[data-year]');
        
        semesterOptions.forEach(option => {
            if (!selectedYear || option.dataset.year === selectedYear) {
                option.style.display = 'block';
            } else {
                option.style.display = 'none';
                if (option.selected) {
                    option.selected = false;
                }
            }
        });
        
        // Reset semester selection if no valid option is visible
        if (selectedYear && semesterSelect.value) {
            const selectedOption = semesterSelect.querySelector(`option[value="${semesterSelect.value}"]`);
            if (selectedOption && selectedOption.style.display === 'none') {
                semesterSelect.value = '';
            }
        }
    }
    
    academicYearSelect.addEventListener('change', filterSemesters);
    
    // Initial filter on page load
    filterSemesters();
    
    // Auto-submit form on filter change (with debouncing for text inputs)
    const filterInputs = document.querySelectorAll('#filterForm select, #filterForm input');
    filterInputs.forEach(input => {
        if (input.type === 'text') {
            let timeout;
            input.addEventListener('input', function() {
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    document.getElementById('filterForm').submit();
                }, 800); // Increased debounce time
            });
        } else {
            input.addEventListener('change', function() {
                document.getElementById('filterForm').submit();
            });
        }
    });
});

function toggleStudentGrades(studentId) {
    const gradesSection = document.getElementById(`grades-${studentId}`);
    const chevronIcon = document.querySelector(`[data-student-id="${studentId}"] .chevron-icon`);
    
    if (gradesSection.classList.contains('show')) {
        gradesSection.classList.remove('show');
        chevronIcon.classList.remove('bi-chevron-down');
        chevronIcon.classList.add('bi-chevron-right');
    } else {
        gradesSection.classList.add('show');
        chevronIcon.classList.remove('bi-chevron-right');
        chevronIcon.classList.add('bi-chevron-down');
    }
}

function expandAll() {
    const allGradeSections = document.querySelectorAll('.student-grades');
    const allChevrons = document.querySelectorAll('.chevron-icon');
    
    allGradeSections.forEach(section => {
        section.classList.add('show');
    });
    
    allChevrons.forEach(chevron => {
        chevron.classList.remove('bi-chevron-right');
        chevron.classList.add('bi-chevron-down');
    });
    
    // Show success message
    showNotification('All student records expanded', 'success');
}

function collapseAll() {
    const allGradeSections = document.querySelectorAll('.student-grades');
    const allChevrons = document.querySelectorAll('.chevron-icon');
    
    allGradeSections.forEach(section => {
        section.classList.remove('show');
    });
    
    allChevrons.forEach(chevron => {
        chevron.classList.remove('bi-chevron-down');
        chevron.classList.add('bi-chevron-right');
    });
    
    // Show success message
    showNotification('All student records collapsed', 'success');
}

function clearFilters() {
    const form = document.getElementById('filterForm');
    const inputs = form.querySelectorAll('input, select');
    inputs.forEach(input => {
        if (input.type === 'text') {
            input.value = '';
        } else {
            input.selectedIndex = 0;
        }
    });
    form.submit();
}

function downloadPDF() {
    const currentURL = new URL(window.location);
    currentURL.pathname = currentURL.pathname.replace('/list/', '/download-pdf/');
    window.open(currentURL.toString(), '_blank');
}

function exportToExcel() {
    // Show loading state
    const btn = event.target;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<i class="bi bi-arrow-repeat spin"></i> Exporting...';
    btn.disabled = true;
    
    // Simulate export process (replace with actual implementation)
    setTimeout(() => {
        btn.innerHTML = originalText;
        btn.disabled = false;
        showNotification('Excel export functionality to be implemented', 'info');
    }, 2000);
}

function showNotification(message, type = 'info') {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
    notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    notification.innerHTML = `
        <i class="bi bi-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    // Add to page
    document.body.appendChild(notification);
    
    // Auto-remove after 3 seconds
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 3000);
}

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl/Cmd + E to expand all
    if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
        e.preventDefault();
        expandAll();
    }
    
    // Ctrl/Cmd + C to collapse all
    if ((e.ctrlKey || e.metaKey) && e.key === 'q') {
        e.preventDefault();
        collapseAll();
    }
});
</script>

<style>
.student-card {
    transition: all 0.3s ease;
    background: #fff;
    border: 1px solid #e3e6f0 !important;
}

.student-card:hover {
    box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
    border-color: #5a5c69 !important;
}

.student-header {
    transition: background-color 0.2s ease;
}

.student-header:hover {
    background-color: #f8f9fc;
}

.cursor-pointer {
    cursor: pointer;
}

.chevron-icon {
    transition: transform 0.3s ease;
    font-size: 0.875rem;
}

.chevron-icon.bi-chevron-down {
    transform: rotate(0deg);
}

.chevron-icon.bi-chevron-right {
    transform: rotate(0deg);
}

.student-grades {
    transition: all 0.3s ease;
    max-height: 0;
    overflow: hidden;
}

.student-grades.show {
    max-height: none;
    overflow: visible;
}

.stat-box {
    padding: 0.5rem;
}

.table th {
    background-color: #f8f9fa;
    font-weight: 600;
    font-size: 0.875rem;
    border-bottom: 2px solid #dee2e6;
    color: #5a5c69;
}

.table td {
    vertical-align: middle;
    font-size: 0.875rem;
    border-bottom: 1px solid #e3e6f0;
}

.table tbody tr:hover {
    background-color: #f8f9fc;
}

.badge {
    font-size: 0.75rem;
    font-weight: 500;
}

.card {
    border: none;
    box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
}

.card-header {
    background-color: #f8f9fc;
    border-bottom: 1px solid #e3e6f0;
}

.pagination .page-link {
    color: #5a5c69;
    border: 1px solid #e3e6f0;
}

.pagination .page-item.active .page-link {
    background-color: #5a5c69;
    border-color: #5a5c69;
}

.form-label {
    font-weight: 600;
    color: #5a5c69;
    margin-bottom: 0.5rem;
}

.form-select, .form-control {
    border: 1px solid #d1d3e2;
    border-radius: 0.35rem;
    font-size: 0.875rem;
}

.form-select:focus, .form-control:focus {
    border-color: #bac8f3;
    box-shadow: 0 0 0 0.2rem rgba(78, 115, 223, 0.25);
}

.btn {
    font-size: 0.875rem;
    border-radius: 0.35rem;
}

.btn-primary {
    background-color: #4e73df;
    border-color: #4e73df;
}

.btn-primary:hover {
    background-color: #2e59d9;
    border-color: #2653d4;
}

.btn-success {
    background-color: #1cc88a;
    border-color: #1cc88a;
}

.btn-outline-secondary {
    color: #858796;
    border-color: #d1d3e2;
}

.btn-outline-secondary:hover {
    background-color: #858796;
    border-color: #858796;
}

.text-primary {
    color: #5a5c69 !important;
}

.fw-medium {
    font-weight: 500;
}

@media print {
    .btn, .card-header .btn-group, .pagination, .student-header {
        display: none !important;
    }
    
    .student-grades {
        max-height: none !important;
        overflow: visible !important;
    }
    
    .student-card {
        break-inside: avoid;
        page-break-inside: avoid;
        margin-bottom: 1rem;
    }
    
    .table {
        font-size: 0.75rem;
    }
    
    .card {
        box-shadow: none;
        border: 1px solid #dee2e6;
    }
}



.form-label {
    font-weight: 600;
    color: #495057;
    margin-bottom: 0.5rem;
}

.form-select, .form-control {
    border: 1px solid #ced4da;
    border-radius: 0.375rem;
}

.form-select:focus, .form-control:focus {
    border-color: #86b7fe;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

.text-primary {
    color: #0d6efd !important;
}

.text-success {
    color: #198754 !important;
}

.text-info {
    color: #0dcaf0 !important;
}

.text-warning {
    color: #ffc107 !important;
}

.text-danger {
    color: #dc3545 !important;
}

.bg-primary {
    background-color: #0d6efd !important;
}

.bg-success {
    background-color: #198754 !important;
}

.bg-info {
    background-color: #0dcaf0 !important;
}

.bg-warning {
    background-color: #ffc107 !important;
}

.bg-danger {
    background-color: #dc3545 !important;
}

.loading-spinner {
    display: none;
    text-align: center;
    padding: 2rem;
}

.loading-spinner.show {
    display: block;
}

.filter-badge {
    display: inline-block;
    margin: 0.25rem;
    padding: 0.5rem 1rem;
    background-color: #e9ecef;
    border-radius: 1rem;
    font-size: 0.875rem;
}

.filter-badge .btn-close {
    font-size: 0.75rem;
    margin-left: 0.5rem;
}
</style>

{% endblock %}